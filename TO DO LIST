(do last)1. BFS that all nodes can be reached
2. handle third party entites